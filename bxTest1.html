<!DOCTYPE html>
<html>
<head>

    <script type="text/javascript" src="box2d.js"></script>
	<script src="jquery.js"></script>
	<script src="VecUtils.js"></script>
	<script src="WorldPlotter.js"></script>
	<script src="Segway.js"></script>
	<script src="SegwayWorld.js"></script>
	<script type="text/javascript">  
		
		$(document).ready(function() {
			'use strict';
			var world = segwayWorld();
			var plotter = worldPlotter(world,document.getElementById("canvas"));
			var mySegway = segway(world);
		
			function step() {
				world.Step(1/60, 3, 2);
				plotter.drawWorld();
				var bodyangle = mySegway.getBodyAngle();
				var bodyanglespeed =  mySegway.getBodyAngleSpeed();
				var speed = mySegway.getWheelSpeed();
				mySegway.setWheelSpeed(1);
				mySegway.setWheelSpeed(-1);
				$("#status").html("Angle is "+bodyangle.toFixed(2)+" rad. body angle speed : "+ bodyanglespeed.toFixed(2) +  "  and speed is "+speed.toFixed(2));
				
				if( Math.abs(bodyangle) > 1.55) return;
				
				setTimeout(function(){step()},10);
			}	

			setTimeout(function(){step()},10);
		});
	</script>

</head>

<body>
	<canvas id='canvas' width="640" height="480"></canvas>
	<div id="status" style="width:640px;height:100px;border:solid 1px gray;"></div>
</body>
</html>